spring.application.name=gas-agency-system
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect


spring.datasource.url=${DB_URL}
spring.datasource.driverClassName=org.postgresql.Driver
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}


# Hikari Pool (optimized for concurrency)
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.connection-timeout=10000
spring.datasource.hikari.leak-detection-threshold=60000

# H2 Console (disabled in production)
spring.h2.console.enabled=false

# Server
server.port=8080
server.servlet.context-path=/

# Logging (production)
logging.level.root=WARN
logging.level.com.gasagency=INFO
logging.level.com.gasagency.service=INFO
logging.level.com.gasagency.controller=INFO
logging.level.com.gasagency.exception=WARN
logging.level.com.gasagency.audit=INFO
logging.level.org.springframework.web=WARN
logging.level.org.springframework.security=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN

# SQL Query Logging (disabled in production for performance)
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.use_sql_comments=false
spring.jpa.properties.hibernate.generate_statistics=false

# Disable Open-In-View to avoid N+1 queries during view rendering
spring.jpa.open-in-view=false

# Lazy loading config
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=false

app.cors.allowed-origins=${CORS_ALLOWED_ORIGINS}
app.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
app.cors.allowed-headers=Content-Type,Authorization,X-XSRF-TOKEN
app.cors.max-age=3600
app.cors.allow-credentials=true

# CSRF enabled in production
app.security.csrf.enabled=true

# JWT secret (set in environment)
app.jwt.secret=${JWT_SECRET}

# Cookie settings
app.security.cookie.secure=true
app.security.cookie.same-site=Lax
app.security.cookie.domain=${COOKIE_DOMAIN:}

# Request and timeout configuration
server.tomcat.threads.max=200
server.tomcat.threads.min-spare=50
server.tomcat.accept-count=150
server.tomcat.connection-timeout=20000
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s

# Keep async requests (SSE) open without timing out
spring.mvc.async.request-timeout=0

# Response compression (faster data transmission)
server.compression.enabled=true
server.compression.min-response-size=1024
server.compression.mime-types=application/json,text/html,text/xml,text/plain,text/css,application/javascript

# JPA/Hibernate performance optimization
spring.jpa.properties.jakarta.persistence.lock.timeout=5000
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Query optimization
spring.jpa.properties.hibernate.jdbc.fetch_size=50

# Second-level caching (reports, dashboard)
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=10m

# Connection pool enhancements
spring.datasource.hikari.auto-commit=true
spring.datasource.hikari.initialization-fail-timeout=1000

# Query timeout for long-running operations
spring.jpa.properties.jakarta.persistence.query.timeout=60000